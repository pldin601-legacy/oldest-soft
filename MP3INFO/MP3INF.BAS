'$FORM Mp3ifrm
DECLARE FUNCTION GetMp3Song$ (Song AS STRING)
DECLARE FUNCTION GetMp3Artist$ (Song AS STRING)
DECLARE FUNCTION GetMp3Some$ (Song AS STRING)
DECLARE FUNCTION NextZero (stn AS STRING) AS INTEGER
STACK 33000
IF COMMAND$ = "" THEN
 PRINT : PRINT
 PRINT "Quadrosoft MP3 file information reader 1.0"
 PRINT "UA 2000-2001 by RMK from BRK."
 PRINT
 PRINT "     Usage   : MP3INFO.EXE [MP3_FILE_NAME]"
 PRINT "     Example : MP3INFO.exe [d:\scooter\rebels.mp3"
 PRINT ""
 END
END IF

mp3artist$ = GetMp3Artist$(COMMAND$)
Mp3Song$ = GetMp3Song$(COMMAND$)
Mp3Some$ = GetMp3Some$(COMMAND$)

Mp3ifrm.txtArtist.text = mp3artist$

screen.controlpanel(7) = 0
Mp3ifrm.SHOW 1

FUNCTION GetMp3Artist$ (Song AS STRING)

DIM BIS AS STRING * 32000
DIM SEA, RECS, COCO

ON ERROR RESUME NEXT

OPEN Song FOR RANDOM AS #10 LEN = LEN(BIS)
RECS = (LOF(10) / LEN(BIS)) + 1
FOR SEA = RECS TO (RECS - 5) STEP -1
GET #10, SEA, BIS
COCO = INSTR(1, BIS, "TAG")
IF COCO > 0 THEN EXIT FOR
NEXT
CLOSE
IF COCO = 0 THEN EXIT FUNCTION

GetMp3Artist = MID$(MID$(BIS, COCO + 33, 30), 1)

END FUNCTION

FUNCTION GetMp3Some$ (Song AS STRING)


DIM BIS AS STRING * 32000
DIM SEA, RECS, COCO

ON ERROR RESUME NEXT

OPEN Song FOR RANDOM AS #10 LEN = LEN(BIS)
RECS = (LOF(10) / LEN(BIS)) + 1
FOR SEA = RECS TO (RECS - 5) STEP -1
GET #10, SEA, BIS
COCO = INSTR(1, BIS, "TAG")
IF COCO > 0 THEN EXIT FOR
NEXT
CLOSE
IF COCO = 0 THEN EXIT FUNCTION

GetMp3Some = MID$(MID$(BIS, COCO + 63, 30), 1)


END FUNCTION

FUNCTION GetMp3Song$ (Song AS STRING)
DIM BIS AS STRING * 32000
DIM SEA, RECS, COCO

ON ERROR RESUME NEXT

OPEN Song FOR RANDOM AS #10 LEN = LEN(BIS)
RECS = (LOF(10) / LEN(BIS)) + 1
FOR SEA = RECS TO (RECS - 5) STEP -1
GET #10, SEA, BIS
COCO = INSTR(1, BIS, "TAG")
IF COCO > 0 THEN EXIT FOR
NEXT
CLOSE
IF COCO = 0 THEN EXIT FUNCTION

GetMp3Song = MID$(MID$(BIS, COCO + 3, 30), 1)


END FUNCTION

FUNCTION NextZero (stn AS STRING) AS INTEGER
FOR x = 1 TO LEN(stn)
IF ASC(MID$(stn, x, 1)) = 0 THEN NextZero = x: EXIT FUNCTION
NEXT
END FUNCTION

